<!DOCTYPE html>
<html lang="en">
<head>
	<script type="text/javascript">
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
		// Function to dynamically get the client Id from the URL if it is already set
		function getClientIdFromUrl() {
		    var url = window.location.href;
		    var regex = new RegExp("[?&]clientId(=([^&#]*)|&|#|$)"),
		    results = regex.exec(url);
		    if (!results) return null;
		    if (!results[2]) return '';
		    return decodeURIComponent(results[2].replace(/\+/g, " "));
		    console.log(results)
		}

		ga('create', 'UA-119023979-1', 'auto', {'clientId': getClientIdFromUrl()}, {'allowLinker': true});
		ga('require', 'linker');
		ga('linker:autoLink', ['https://davidhayneshasgithub.github.io/zauiTestGA/','https://http://seymour.zaui.com/dhaynes/zauitourclean/modules/webBooking'] );
		ga('require', 'displayfeatures');
		ga('send', 'pageview');
	</script>
	<script>
	//declares the variable
	var clientId

	if (typeof ga === "function") { 
	//sets the client id variable to the GA tracker from the cookies if it is set
	  ga(function(tracker) {
	    clientId = tracker.get('clientId');
	  });
	}
	var getClientId = function(){	
	 //adds a clientId URI parameter if the clientId isnt null
	  if(clientId != null){
	    var urlOptions = function(url) {
	    	return 'http://seymour.zaui.com/dhaynes/zauitourclean/modules/webBooking/index.php?clientId=' + clientId;
	    } 
	  }else{
	    //dont add the clientId parameter
	    var urlOptions = function(url) {
	    return 'http://seymour.zaui.com/dhaynes/zauitourclean/modules/webBooking/index.php';
	    }
	  }
	}
	</script>
</head>

	<meta charset="UTF-8">
	<title>Zaui Demo Analytics iFrame Site</title>
</head>
<body>

	<h1>A basic page with an iFrame embedded button to demonstrate how it is best configured</h1>

	<a href="http://seymour.zaui.com/dhaynes/zauitourclean/modules/webBooking/index.php" onclick="return Zaui.open(event)" class="zaui-embed-button override">click me</a><script>(function(d,t,i,u,z,s) {if (!d.getElementById(i)) {z = d.createElement(t); z.id=i; z.async=1; z.src = u;s = d.getElementsByTagName(t)[0]; s.parentNode.insertBefore(z, s);}})(document, 'script', 'zaui-embed-src', 'http://seymour.zaui.com/dhaynes/zauitourclean/themes/default/modules/webBooking/js/embed.js');</script>
	
	<h1>A deep link button to a test booking portal</h1>
	<form method="get" >
   		<button type="submit" onClick="getClientId()">Click Me</button>
	</form>

</body>
</html>
